
#!/bin/bash
# change_theme.sh
# Usage: ./change_theme.sh <image_filename>

if [ "$#" -ne 1 ]; then
    echo "Usage: $0 <path_to_image>"
    exit 1
fi

WALL_DIR="$HOME/Pictures/Wallpaper"
IMAGE="$1"
IMAGEFULL="$WALL_DIR/$IMAGE"
TEMP_IMAGE="$HOME/tmp/pywal_temp_image.png"

notify-send "ðŸŽ¨ Changing Theme" "Applying new wallpaper and updating colors..."
pkill -9 spotify

Create blurred temp image for Pywal color extraction
# magick "$IMAGEFULL" \
#     \( -size "75x75" xc:black -alpha set -channel Alpha -evaluate Set 30% \) \
#     -gravity Center -composite \
#     \( -size "50x50" xc:black -alpha set -channel Alpha -evaluate Set 60% \) \
#     -gravity Center -composite \
#     \( -size "25x25" xc:black -alpha set -channel Alpha -evaluate Set 90% \) \
#     -gravity Center -composite "$TEMP_IMAGE"

wal -i "$IMAGEFULL" -n -s -t -e
matugen image "$IMAGEFULL"

swww img "$IMAGEFULL" --transition-type fade --transition-duration 1

pywal-spicetify SharkBlue

sleep 0.5

hyprctl dispatch togglespecialworkspace magic

rm -f "$TEMP_IMAGE"

notify-send "âœ… Theme Applied" "Wallpaper, colors, and Spotify magic pad ready!"
